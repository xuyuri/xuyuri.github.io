<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>漫谈微信支付-公共号支付 | Yuri&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="漫谈微信支付-公共号支付">
<meta property="og:type" content="article">
<meta property="og:title" content="漫谈微信支付-公共号支付">
<meta property="og:url" content="http://yurixu.com/blog/2016/08/16/漫谈微信支付-公共号支付/index.html">
<meta property="og:site_name" content="Yuri's Blog">
<meta property="og:description" content="漫谈微信支付-公共号支付">
<meta property="og:image" content="http://7xrc03.com1.z0.glb.clouddn.com/%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98.jpeg">
<meta property="og:image" content="http://7xrc03.com1.z0.glb.clouddn.com/APP-%E6%8B%89%E8%B5%B7%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98.png">
<meta property="og:image" content="http://7xrc03.com1.z0.glb.clouddn.com/%E5%85%AC%E5%85%B1%E5%8F%B7%E6%8B%89%E8%B5%B7%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98.png">
<meta property="og:image" content="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E6%94%AF%E4%BB%98%E5%9C%BA%E6%99%AF%E9%9D%9E%E6%B3%95.png">
<meta property="og:image" content="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E4%B8%8D%E5%85%81%E8%AE%B8%E8%B7%A8%E5%8F%B7%E6%94%AF%E4%BB%98.png">
<meta property="og:image" content="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E7%BC%BA%E5%B0%91openid.png">
<meta property="og:image" content="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E7%BC%BA%E5%B0%91timeStamp.png">
<meta property="og:image" content="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E7%AD%BE%E5%90%8D%E5%A4%B1%E8%B4%A5.png">
<meta property="og:image" content="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/body%E5%8F%82%E6%95%B0%E9%95%BF%E5%BA%A6%E6%9C%89%E8%AF%AF.png">
<meta property="og:image" content="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/URL%E6%9C%AA%E6%B3%A8%E5%86%8C.png">
<meta property="og:image" content="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E4%B8%8B%E5%8D%95%E8%B4%A6%E5%8F%B7%E4%B8%8E%E6%94%AF%E4%BB%98%E8%B4%A6%E5%8F%B7%E4%B8%8D%E4%B8%80%E8%87%B4.png">
<meta property="og:image" content="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E5%95%86%E6%88%B7%E8%AE%A2%E5%8D%95%E5%8F%B7%E9%87%8D%E5%A4%8D.png">
<meta property="og:image" content="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E8%AE%A2%E5%8D%95%E5%B7%B2%E8%BF%87%E6%9C%9F.png">
<meta property="og:updated_time" content="2018-05-22T02:15:12.175Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="漫谈微信支付-公共号支付">
<meta name="twitter:description" content="漫谈微信支付-公共号支付">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <!--link href="//fonts.useso.com/css?family=Lato:400,400italic" rel="stylesheet" type="text/css"-->
  <link href="http://yurixu.com/css/fonts/Google/font.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">  
  
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?3da38d5511434722ab5f79d1cffab2ad";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



  <!--

-->
  

  <!-- add by yurixu 2016/1/13 向百度提交sitemap-->
  <meta name="baidu-site-verification" content="ubBCJmBrxD" />
</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Yuri&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Walk step by step</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories/Read/">Reading</a>
        
          <a class="main-nav-link" href="https://github.com/xuyuri">GitHub</a>
        
          <a class="main-nav-link" href="/atom.xml">RSS</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
        <! --modify by yurixu 22016/1/8 修改search为swiftype -->
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
        <!-- <input type="text" class="st-default-search-input"> -->
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yurixu.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-漫谈微信支付-公共号支付" class="article article-type-post" itemscope itemprop="blogPost">
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      漫谈微信支付-公共号支付
    </h1>
  

      </header>
    
    <!-- add by yurixu 2016/1/3 将文章时间放在标题下 -->
    <div class="article-meta">
      <a href="/blog/2016/08/16/漫谈微信支付-公共号支付/" class="article-date">
  <time datetime="2016-08-16T13:22:48.000Z" itemprop="datePublished">2016-8-16 周二  21:22</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>
  </div>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <!-- add by yurixu 2016/1/3 添加文章目录 -->
        
        <p><img src="http://7xrc03.com1.z0.glb.clouddn.com/%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98.jpeg" alt=""><br>本文对微信公共号支付的实现过程进行详细介绍。</p>
<a id="more"></a>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>公共号支付主要应用于微信内H5页面上发起的微信支付流程，它相对于扫码支付和APP要复杂一些，而且在实际开发过程中遇到的问题相对较多。</p>
<h2 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h2><p>公共号支付与APP支付类似，都需要调起统一下单接口获得prepay_id，根据prepay_id等参数调起微信发起支付流程，最后微信后台将支付结果异步回调给商户后台。<br>◆ <strong>准备工作</strong><br>公共号支付需要提前在微信公共平台进行业务配置，包括设置支付授权目录、设置JS接口安全域名以及设置授权回调页面域名。<br><strong>支付授权目录:</strong><br>位置：微信支付——&gt;开发配置——&gt;公共号支付<br>[1] 所有使用公众号支付方式发起支付请求的链接地址，都必须在支付授权目录之下；<br>[2] 正式支付授权目录最多设置3个，测试授权目录最多设置1个，且域名必须通过ICP备案；<br>[3] 头部要包含http或https，须细化到二级或三级目录，以左斜杠“/”结尾。<br>业务中发起支付的页面地址必须在授权目录下，否则调用下单接口时会提示“当前页面的URL未注册”。<br><strong>JS接口安全域名:</strong><br>位置：微信支付——&gt;公共号设置——&gt;功能设置——&gt;JS接口安全域名<br>设置JS接口安全域名后，公众号开发者可在该域名下调用微信开放的JS接口。<br>注意事项：<br>[1] 可填写三个域名，要求是一级或一级以上域名（例：qq.com，或者 <a href="http://www.qq.com" target="_blank" rel="external">www.qq.com</a> ），需使用字母、数字及“-”的组合，不支持IP地址及端口号；<br>[2] 填写的域名须通过ICP备案的验证；<br>[3] 一个自然月内最多可修改并保存三次。<br><strong>授权回调页面域名:</strong><br>位置：微信支付——&gt;接口权限——&gt;网页授权获取用户基本信息<br>用户在网页授权页同意授权给公众号后，微信会将授权数据传给一个回调页面，回调页面需在此域名下，以确保安全可靠。<br>注意事项：<br>[1] 回调页面域名需使用字母、数字及“-”的组合，不支持IP地址及端口号。填写的域名需与实际回调URL中的域名相同；<br>[2] 填写的域名须通过ICP备案的验证。<br>获取用户授权时redirect_uri对应的URL必须在此域名下，否则回调的地址会无法打开。<br>◆ <strong>统一下单</strong><br>公共号支付统一下单接口需要传递openid参数，微信公共平台对于openid的解释如下：<font color="#0099ff" size="3" face="楷体"><br>在关注者与公众号产生消息交互后，公众号可获得关注者的OpenID（加密后的微信号，每个用户对每个公众号的OpenID是唯一的。对于不同公众号，同一用户的openid不同）。<br>公众号可根据以下接口来获取用户的openid，如需获取用户的昵称、头像、性别、所在城市、语言和关注时间，则需要用户授权。<br>参考信息：<a href="http://mp.weixin.qq.com/wiki/17/c0f37d5704f0b64713d5d2c37b468d75.html" target="_blank" rel="external">http://mp.weixin.qq.com/wiki/17/c0f37d5704f0b64713d5d2c37b468d75.html</a><br>开发者如果需要将同一个用户在不同公众号下的openid统一为一个id来记录，可以参考以下接口：<br>参考信息：<a href="http://mp.weixin.qq.com/wiki/14/bb5031008f1494a59c6f71fa0f319c66.html" target="_blank" rel="external">http://mp.weixin.qq.com/wiki/14/bb5031008f1494a59c6f71fa0f319c66.html</a></font><br>即openid其实是每个用户在不同公共号内的唯一标示，获取openid需要先经过用户同意授权，获取code，再通过code获取openid。<br>◆ <strong>获取用户授权</strong><br>微信提供了两种授权方式：snsapi_base和snsapi_userinfo。<br>snsapi_base：不弹出授权页面，直接跳转，只能获取用户openid；<br>snsapi_userinfo：弹出授权页面，可通过openid拿到昵称、性别、所在地。并且，即使在未关注的情况下，只要用户授权，也能获取其信息。<br>想要获取code，需要构造如下地址：<br><code>https://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE#wechat_redirect</code><br>其中SCOPE参数为snsapi_base或snsapi_userinfo，REDIRECT_URI为获取用户授权后跳转的地址。<br>此处需要在微信公共平台配置授权回调页面域名:<code>微信公共平台——&gt;接口权限——&gt;网页授权获取用户基本信息</code>，点击“修改”，在弹出的页面中填写授权回调页面域名，REDIRECT_URI所在的域名要与填写的回调页面域名相同，否则在进行用户授权时会提示redirect_uri错误。<br>获取code后，再请求以下链接获取openid：<br><code>https://api.weixin.qq.com/sns/oauth2/access_token?appid=APPID&amp;secret=SECRET&amp;code=CODE&amp;grant_type=authorization_code</code><br>其中APPID为公共号唯一标示，SECRET为公共号APPSECRET。<br>有关如何获取用户openid的详细内容可以参考微信官网文档<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421140842&amp;token=&amp;lang=zh_CN" target="_blank" rel="external">网页授权获取用户基本信息</a>(PS：以上这是最新版的公共号开发文档，这是<a href="http://mp.weixin.qq.com/wiki/17/c0f37d5704f0b64713d5d2c37b468d75.html" target="_blank" rel="external">旧版</a>的文档，建议查看新版文档)<br>微信公共号支付SDK文件JsApiPay类提供了获取用户openid的方法GetOpenid：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">   * </span><br><span class="line">   * 通过跳转获取用户的openid，跳转流程如下：</span><br><span class="line">   * 1、设置自己需要调回的url及其其他参数，跳转到微信服务器https://open.weixin.qq.com/connect/oauth2/authorize</span><br><span class="line">   * 2、微信服务处理完成之后会跳转回用户redirect_uri地址，此时会带上一些参数，如：code</span><br><span class="line">   * </span><br><span class="line">   * <span class="doctag">@return</span> 用户的openid</span><br><span class="line">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">GetOpenid</span><span class="params">()</span></span><br><span class="line">  </span>&#123;</span><br><span class="line">    <span class="comment">//通过code获得openid</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'code'</span>]))&#123;</span><br><span class="line">      <span class="comment">//触发微信返回code码</span></span><br><span class="line">      <span class="variable">$baseUrl</span> = urlencode(<span class="string">'http://'</span>.<span class="variable">$_SERVER</span>[<span class="string">'HTTP_HOST'</span>].<span class="variable">$_SERVER</span>[<span class="string">'PHP_SELF'</span>].<span class="variable">$_SERVER</span>[<span class="string">'QUERY_STRING'</span>]);</span><br><span class="line">      <span class="variable">$url</span> = <span class="variable">$this</span>-&gt;__CreateOauthUrlForCode(<span class="variable">$baseUrl</span>);</span><br><span class="line">      Header(<span class="string">"Location: $url"</span>);</span><br><span class="line">      <span class="keyword">exit</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">//使用code码，以获取openid</span></span><br><span class="line">        <span class="variable">$code</span> = <span class="variable">$_GET</span>[<span class="string">'code'</span>];</span><br><span class="line">      <span class="variable">$openid</span> = <span class="variable">$this</span>-&gt;getOpenidFromMp(<span class="variable">$code</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="variable">$openid</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>其中GetOpenidFromMp方法在官方SDK中存在错误，<font color="red">CURLOPT_TIMEOUT</font>写错了：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">   * </span><br><span class="line">   * 通过code从工作平台获取openid机器access_token</span><br><span class="line">   * <span class="doctag">@param</span> string $code 微信跳转回来带上的code</span><br><span class="line">   * <span class="doctag">@return</span> openid</span><br><span class="line">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">GetOpenidFromMp</span><span class="params">(<span class="variable">$code</span>)</span></span><br><span class="line">  </span>&#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="variable">$this</span>-&gt;__CreateOauthUrlForOpenid(<span class="variable">$code</span>);</span><br><span class="line">    <span class="comment">//初始化curl</span></span><br><span class="line">    <span class="variable">$ch</span> = curl_init();</span><br><span class="line">    <span class="comment">//设置超时</span></span><br><span class="line">    <span class="comment">//curl_setopt($ch, CURLOP_TIMEOUT, 30);		//CURLOP_TIMEOUT写错了！！！！应该是CURLOPT_TIMEOUT</span></span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_TIMEOUT, <span class="number">30</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_SSL_VERIFYPEER,<span class="keyword">FALSE</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_SSL_VERIFYHOST,<span class="keyword">FALSE</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="keyword">FALSE</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="keyword">TRUE</span>);</span><br><span class="line">    <span class="keyword">if</span>(WxPayConfig::CURL_PROXY_HOST != <span class="string">"0.0.0.0"</span> </span><br><span class="line">      &amp;&amp; WxPayConfig::CURL_PROXY_PORT != <span class="number">0</span>)&#123;</span><br><span class="line">      curl_setopt(<span class="variable">$ch</span>,CURLOPT_PROXY, WxPayConfig::CURL_PROXY_HOST);</span><br><span class="line">      curl_setopt(<span class="variable">$ch</span>,CURLOPT_PROXYPORT, WxPayConfig::CURL_PROXY_PORT);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//运行curl，结果以json形式返回</span></span><br><span class="line">    <span class="variable">$res</span> = curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">    curl_close(<span class="variable">$ch</span>);</span><br><span class="line">    <span class="comment">//取出openid</span></span><br><span class="line">    <span class="variable">$data</span> = json_decode(<span class="variable">$res</span>,<span class="keyword">true</span>);</span><br><span class="line">    <span class="variable">$this</span>-&gt;data = <span class="variable">$data</span>;</span><br><span class="line">    <span class="variable">$openid</span> = <span class="variable">$data</span>[<span class="string">'openid'</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$openid</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>获取openid后就可以调用统一下单接口获得prepay_id。<br>◆ <strong>H5调起微信支付</strong><br><a href="https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=7_7&amp;index=6" target="_blank" rel="external">网页端调起支付API</a>提供了前端调起微信发起支付的方法，此处需要特别注意：<font color="red">公共号支付调起微信支付的接口参数与APP支付调起微信支付的参数大小写不同！</font><br>APP拉起微信支付接口参数列表：<br><img src="http://7xrc03.com1.z0.glb.clouddn.com/APP-%E6%8B%89%E8%B5%B7%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98.png" alt="APP拉起微信支付"><br>公共号拉起微信支付接口参数列表：<br><img src="http://7xrc03.com1.z0.glb.clouddn.com/%E5%85%AC%E5%85%B1%E5%8F%B7%E6%8B%89%E8%B5%B7%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98.png" alt="公共号拉起微信支付"><br>可以发现变量名一列，公共号接口有的字母是大写的，生成签名是需要区分参数大小写的，所以这块一定要注意，否则在调用接口时你就会一直收到签名错误的提示。<br>签名生成成功了，但是在调用调起微信支付接口时你可能会收到提示”调用支付JSAPI缺少参数：timeStamp，但是明明已经传递该参数了，怎么还会提示缺少参数呢？是由timeStamp的类型引起的，上图的参数列表中timeStamp类型为String字符串类型，很多时候我们程序里直接使用time()生成时间戳是整数，因此在将timeStamp传递给该接口时需要转换为字符串类型。<br>如果是服务器端调用拉起微信支付接口，需要将WxPay.Data.php文件中WxPayJsApiPay的SetTimeStamp方法作相应修改：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">  * 设置支付时间戳</span><br><span class="line">  * <span class="doctag">@param</span> string $value </span><br><span class="line">  **/</span></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">SetTimeStamp</span><span class="params">(<span class="variable">$value</span>)</span></span><br><span class="line">  </span>&#123;</span><br><span class="line">    <span class="comment">//modify by yuri 2016/7/5 解决JSAPI微信支付提示“缺少timeStamp参数”问题</span></span><br><span class="line">    <span class="variable">$this</span>-&gt;values[<span class="string">'timeStamp'</span>] = (string)<span class="variable">$value</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>测试开发时配置好测试授权目录，将微信号添加到测试白名单，H5调用拉起微信支付接口即可完成支付。</p>
<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><p>◆ <strong>支付场景非法</strong><br><img src="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E6%94%AF%E4%BB%98%E5%9C%BA%E6%99%AF%E9%9D%9E%E6%B3%95.png" align="left"><br><br><br><br><br><br><strong>错误场景</strong>：前端调用拉起微信支付接口<code>getBrandWCPayRequest</code>报错。<br><strong>原因分析</strong>：与开发用的APPID有关。JSAPI支付用到的APPID是从微信公告平台申请，APP支付用到的APPID是从微信开放平台申请，如果将APP支付的APPID用于JSAPI支付，就会收到该错误提示。<br><strong>解决方法</strong>：不同的支付场景要使用相对应的APPID，不允许跨场景使用APPID支付。</p>
<p>◆ <strong>您没有JSAPI支付权限</strong><br><strong>错误场景</strong>：后台调用<code>unifiedorder</code>统一下单接口报错。<br><strong>原因分析</strong>：同“支付场景非法”<br><strong>解决方法</strong>：同“支付场景非法”</p>
<p>◆ <strong>不允许跨号支付</strong><br><img src="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E4%B8%8D%E5%85%81%E8%AE%B8%E8%B7%A8%E5%8F%B7%E6%94%AF%E4%BB%98.png" align="left"><br><br><br><br><br><br><br><br><strong>错误场景</strong>：在公共号内调用<code>unifiedorder</code>统一下单接口报错。<br><strong>原因分析</strong>：公共号A申请开通了JSAPI支付，得到该公共号微信支付开发对应的APPID、KEY、APPSECRET，如果在公共号B内调用公共号A开发的微信支付接口，就会提示“不允许跨号支付”，微信侧限制了微信支付开发的相关接口只能在对应的公共号内调用。<br><strong>解决方法</strong>：在微信JSAPI开发中配置的公共号内调用微信支付相关接口。</p>
<p>◆ <strong>缺少openid</strong><br><img src="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E7%BC%BA%E5%B0%91openid.png" align="left"><br><br><br><br><br><br><br><strong>错误场景</strong>：后台调用<code>unifiedorder</code>统一下单接口报错。<br><strong>原因分析</strong>：公共号支付的下单接口需要传递openid参数，为用户在商户appid下的唯一标识。调用统一下单接口时需要先获取用户openid。<br><strong>解决方法</strong>：调用<code>unifiedorder</code>统一下单接口前，确保已经获取到用户openid。</p>
<p>◆ <strong>缺少timeStamp</strong><br><img src="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E7%BC%BA%E5%B0%91timeStamp.png" align="left"><br><br><br><br><br><br><br><br><strong>错误场景</strong>：前端调用拉起微信支付接口<code>getBrandWCPayRequest</code>报错。<br><strong>原因分析</strong>：<code>getBrandWCPayRequest</code>参数列表中写明了timeStamp参数类型为String，如果传递的timeStamp值为整型，会产生该错误。<br><strong>解决方法</strong>：将timeStamp的值显示转换为字符串类型。</p>
<p>◆ <strong>签名失败</strong><br><img src="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E7%AD%BE%E5%90%8D%E5%A4%B1%E8%B4%A5.png" align="left"><br><br><br><br><br><br><strong>错误场景</strong>：前端调用拉起微信支付接口<code>getBrandWCPayRequest</code>报错。<br><strong>原因分析</strong>：公共号支付拉起微信支付接口与APP支付拉起微信支付接口中参数的大小写不同，生成签名会区分大小写。<br><strong>解决方法</strong>：生成签名要严格按照参数列表中变量名称进行生成，尤其注意参数大小写。</p>
<p>◆ <strong>body参数长度有误</strong><br><img src="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/body%E5%8F%82%E6%95%B0%E9%95%BF%E5%BA%A6%E6%9C%89%E8%AF%AF.png" align="left"><br><br><br><br><br><br><strong>错误场景</strong>：后台调用<code>unifiedorder</code>统一下单接口报错。<br><strong>原因分析</strong>：body参数长度太长，unifiedorder统一下单接口中body参数长度为String(128)，即占用128个字节，一个汉字占用3个字节，一个字母或数字占用1个字节，所以如果全部为汉字的话，最多42个。<br><strong>解决方法</strong>：必要时使用字符串截取函数限制body的长度。</p>
<p>◆ <strong>URL未注册</strong><br><img src="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/URL%E6%9C%AA%E6%B3%A8%E5%86%8C.png" align="left"><br><br><br><br><br><br><br><br><strong>错误场景</strong>：前端调用拉起微信支付接口<code>getBrandWCPayRequest</code>报错。<br><strong>原因分析</strong>：授权目录配置问题，当前支付页与授权目录设置不匹配。<br><strong>解决方法</strong>：详细解决方案可参考另一篇博文<a href="http://yurixu.com/blog/2016/08/21/%E6%BC%AB%E8%B0%88%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98-%E6%8E%88%E6%9D%83%E7%9B%AE%E5%BD%95%E8%AE%BE%E7%BD%AE/">&lt;漫谈微信支付-授权目录设置&gt;</a></p>
<p>◆ <strong>下单账号与支付账号不一致</strong><br><img src="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E4%B8%8B%E5%8D%95%E8%B4%A6%E5%8F%B7%E4%B8%8E%E6%94%AF%E4%BB%98%E8%B4%A6%E5%8F%B7%E4%B8%8D%E4%B8%80%E8%87%B4.png" align="left"><br><br><br><br><br><br><strong>错误场景</strong>：前端调用拉起微信支付接口<code>getBrandWCPayRequest</code>报错。前端调用拉起微信支付接口<code>getBrandWCPayRequest</code>，拉起微信账号A，但是在微信A中没有完成支付（例如：执行了取消操作），此时如果换另一个微信账号B，再对微信端同一个订单进行支付，拉起微信，此时会报该错。<br><strong>原因分析</strong>：微信端同一个订单号，限制了下单与支付账号必须使用同一个微信。在调用下单接口时传递了openid，在调用拉起微信支付接口时，如果当前用户的微信与下单微信不同，就会报该错。<br><strong>解决方法</strong>：下单账号与支付账号必须使用同一个微信。</p>
<p>◆ <strong>商户订单号重复</strong><br><img src="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E5%95%86%E6%88%B7%E8%AE%A2%E5%8D%95%E5%8F%B7%E9%87%8D%E5%A4%8D.png" align="left"><br><br><br><br><br><br><strong>错误场景</strong>：后台调用<code>unifiedorder</code>统一下单接口报错。<br><strong>原因分析</strong>：同一个订单，如果修改了商品描述或者商品价格，再用同一个订单号去调用统一下单接口就会报该错。<br><strong>解决方法</strong>：重新生成订单。</p>
<p>◆ <strong>订单已过期</strong><br><img src="http://7xrc03.com1.z0.glb.clouddn.com/wxPay/error/%E8%AE%A2%E5%8D%95%E5%B7%B2%E8%BF%87%E6%9C%9F.png" align="left"><br><br><br><br><br><br><strong>错误场景</strong>：后台调用<code>unifiedorder</code>统一下单接口报错。<br><strong>原因分析</strong>：下单有时效性。<br><strong>解决方法</strong>：重新下单。</p>
<p>◆ <strong>调用微信支付相关接口异常缓慢</strong><br>微信支付SDK中所有最终请求微信服务器的出口均是经过WxPay.Api.php中的<code>postXmlCurl</code>接口：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">   * 以post方式提交xml到对应的接口url</span><br><span class="line">   * <span class="doctag">@param</span> string $xml  需要post的xml数据</span><br><span class="line">   * <span class="doctag">@param</span> string $url  url</span><br><span class="line">   * <span class="doctag">@param</span> bool $useCert 是否需要证书，默认不需要</span><br><span class="line">   * <span class="doctag">@param</span> int $second   url执行超时时间，默认30s</span><br><span class="line">   * <span class="doctag">@throws</span> WxPayException</span><br><span class="line">   */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">postXmlCurl</span><span class="params">(<span class="variable">$xml</span>, <span class="variable">$url</span>, <span class="variable">$useCert</span> = false, <span class="variable">$second</span> = <span class="number">30</span>)</span></span><br><span class="line">  </span>&#123;</span><br><span class="line">    <span class="variable">$ch</span> = curl_init();</span><br><span class="line">    <span class="comment">//设置超时</span></span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_TIMEOUT, <span class="variable">$second</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//如果有配置代理这里就设置代理</span></span><br><span class="line">    <span class="keyword">if</span>(WxPayConfig::CURL_PROXY_HOST != <span class="string">"0.0.0.0"</span> </span><br><span class="line">      &amp;&amp; WxPayConfig::CURL_PROXY_PORT != <span class="number">0</span>)&#123;</span><br><span class="line">      curl_setopt(<span class="variable">$ch</span>,CURLOPT_PROXY, WxPayConfig::CURL_PROXY_HOST);</span><br><span class="line">      curl_setopt(<span class="variable">$ch</span>,CURLOPT_PROXYPORT, WxPayConfig::CURL_PROXY_PORT);</span><br><span class="line">    &#125;</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>,CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>,CURLOPT_SSL_VERIFYPEER,<span class="keyword">FALSE</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>,CURLOPT_SSL_VERIFYHOST,<span class="keyword">FALSE</span>);</span><br><span class="line">    <span class="comment">//设置header</span></span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="keyword">FALSE</span>);</span><br><span class="line">    <span class="comment">//要求结果为字符串且输出到屏幕上</span></span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="keyword">TRUE</span>);</span><br><span class="line">    <span class="comment">//modify by yuri 2016/7/5 设置curl默认访问IPv4网络</span></span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_IPRESOLVE, CURL_IPRESOLVE_V4);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$useCert</span> == <span class="keyword">true</span>)&#123;</span><br><span class="line">      <span class="comment">//设置证书</span></span><br><span class="line">      <span class="comment">//使用证书：cert 与 key 分别属于两个.pem文件</span></span><br><span class="line">      curl_setopt(<span class="variable">$ch</span>,CURLOPT_SSLCERTTYPE,<span class="string">'PEM'</span>);</span><br><span class="line">      curl_setopt(<span class="variable">$ch</span>,CURLOPT_SSLCERT, WxPayConfig::SSLCERT_PATH);</span><br><span class="line">      curl_setopt(<span class="variable">$ch</span>,CURLOPT_SSLKEYTYPE,<span class="string">'PEM'</span>);</span><br><span class="line">      curl_setopt(<span class="variable">$ch</span>,CURLOPT_SSLKEY, WxPayConfig::SSLKEY_PATH);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//post提交方式</span></span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_POST, <span class="keyword">TRUE</span>);</span><br><span class="line">    curl_setopt(<span class="variable">$ch</span>, CURLOPT_POSTFIELDS, <span class="variable">$xml</span>);</span><br><span class="line">    <span class="comment">//运行curl</span></span><br><span class="line">    <span class="variable">$data</span> = curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">    <span class="comment">//返回结果</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$data</span>)&#123;</span><br><span class="line">      curl_close(<span class="variable">$ch</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">      <span class="variable">$error</span> = curl_errno(<span class="variable">$ch</span>);</span><br><span class="line">      curl_close(<span class="variable">$ch</span>);</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> WxPayException(<span class="string">"curl出错，错误码:$error"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>因为CURL默认先解析IPV6，再解析IPV4，所以如果你的支付场景只有IPV4网络，则最好设置CURL默认访问IPV4，这样可以省去解析IPV6的时间，接口调用速度明显加快。<br>转载请注明出处：<a href="http://yurixu.com/blog/2016/08/16/漫谈微信支付-公共号支付/">http://yurixu.com/blog/2016/08/16/漫谈微信支付-公共号支付/</a></p>

      
    </div>
    <footer class="article-footer">
      <!-- modify by yurixu 2016/1/1 replace Share -->
      <a data-url="http://yurixu.com/blog/2016/08/16/漫谈微信支付-公共号支付/" data-id="cjhh1wweq001avsrdkw757vgu" class="article-share-link bdsharebuttonbox" data-cmd="more">分享</a>
      <script>
      window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
      </script>
      <!-- add by yurixu 2016/1/6 修改评论定位 -->
      
        <a href="/blog/2016/08/16/漫谈微信支付-公共号支付/#comments" class="article-comment-link">留言</a>
      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/支付/">支付</a></li></ul>

      <!--添加单篇文章阅读量统计-->
      <span id="busuanzi_container_page_pv">
        本文总阅读量<span id="busuanzi_value_page_pv"></span>次
      </span>
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/2016/08/17/file-get-contents-Unable-to-find-the-wrapper-https/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          file_get_contents(): Unable to find the wrapper https
        
      </div>
    </a>
  
  
    <a href="/blog/2016/08/14/2016年上半年读书情况/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">2016年上半年读书情况</div>
    </a>
  
</nav>

  
</article>


  <section id="comments">
    <!-- 多说评论框 start -->
      <div class="ds-thread" data-thread-key="post-漫谈微信支付-公共号支付" data-title="漫谈微信支付-公共号支付" data-url="http://yurixu.com/blog/2016/08/16/漫谈微信支付-公共号支付/"></div>
      <!-- 多说评论框 end -->
      <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
      <script type="text/javascript">
      var duoshuoQuery = {short_name:'yurixu'};
        (function() {
          var ds = document.createElement('script');
          ds.type = 'text/javascript';ds.async = true;
          ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
          ds.charset = 'UTF-8';
          (document.getElementsByTagName('head')[0] 
           || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
        </script>
      <!-- 多说公共JS代码 end -->
  </section>
  

  <!-- 向百度自动推送-->
  <script>
  (function(){
      var bp = document.createElement('script');
      bp.src = '//push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();
  </script></section>
        
      </div>
      <footer id="footer">
  
    <aside id="sidebar" class="outer">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP-网络技术/">PHP 网络技术</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Read/">Read</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/总结/">总结</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书笔记/">读书笔记</a><span class="category-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Excel/">Excel</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FFmpeg/">FFmpeg</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/">MySQL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/">Mysql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/">PHP</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP-POST/">PHP POST</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Read/">Read</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sublime/">Sublime</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/issue/">issue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/博客/">博客</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/存储过程/">存储过程</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/总结/">总结</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/支付/">支付</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文件/">文件</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络/">网络</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/阅读/">阅读</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Excel/" style="font-size: 10px;">Excel</a> <a href="/tags/FFmpeg/" style="font-size: 10px;">FFmpeg</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/MySQL/" style="font-size: 10px;">MySQL</a> <a href="/tags/Mysql/" style="font-size: 10px;">Mysql</a> <a href="/tags/PHP/" style="font-size: 20px;">PHP</a> <a href="/tags/PHP-POST/" style="font-size: 10px;">PHP POST</a> <a href="/tags/Python/" style="font-size: 13.33px;">Python</a> <a href="/tags/Read/" style="font-size: 16.67px;">Read</a> <a href="/tags/Sublime/" style="font-size: 11.67px;">Sublime</a> <a href="/tags/issue/" style="font-size: 10px;">issue</a> <a href="/tags/博客/" style="font-size: 15px;">博客</a> <a href="/tags/存储过程/" style="font-size: 10px;">存储过程</a> <a href="/tags/总结/" style="font-size: 10px;">总结</a> <a href="/tags/支付/" style="font-size: 18.33px;">支付</a> <a href="/tags/文件/" style="font-size: 10px;">文件</a> <a href="/tags/网络/" style="font-size: 10px;">网络</a> <a href="/tags/阅读/" style="font-size: 11.67px;">阅读</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">7</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2016/11/10/统计数据表各列非空值的数量/">统计数据表各列非空值的数量</a>
          </li>
        
          <li>
            <a href="/blog/2016/09/06/Postman-接口调试工具使用简介/">Postman接口调试工具使用简介</a>
          </li>
        
          <li>
            <a href="/blog/2016/09/02/FFmpeg音视频转换/">FFmpeg音视频转换</a>
          </li>
        
          <li>
            <a href="/blog/2016/08/30/Sublime-Text-3-编译运行PHP/">Sublime Text 3 编译运行PHP</a>
          </li>
        
          <li>
            <a href="/blog/2016/08/24/几种模拟POST请求的方式汇总/">几种模拟POST请求的方式汇总</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
    
  <!-- add by yurixu 2016/1/3 add bottom -->
  <div class="outer">
    <div id="footer-info" class="inner" style="text-align:center;">
	  <table width="100%" border="0">
        <tr>
          <td style="text-align:left">          
            Copyright &copy; 2018 Yurixu &nbsp; &nbsp;
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a><br>
	        <span id="busuanzi_container_site_uv">Total visit <span id="busuanzi_value_site_uv"></span> times</span> &nbsp; &nbsp; &nbsp; &nbsp;
	        <span id="busuanzi_container_site_pv">Total views <span id="busuanzi_value_site_pv"></span> times</span> 
		  </td>
		  <td style="text-align:right">
		    <div style="font-family: FontAwesome;font-size: 20px;">
		    <a href="http://weibo.com/xywEliot" title="微博" target="_blank">&#61834;</a>&nbsp;		
			<a href="http://user.qzone.qq.com/864909480" title="QQ空间" target="_blank">&#61910;</a>&nbsp;
		    <a href="https://github.com/xuyuri" title="GitHub" target="_blank">&#61595;</a>&nbsp;
		    <a href="http://www.linkedin.com/in/yurixu" title="LinkedIn" target="_blank">&#61665;</a>&nbsp;			    	
			</div><br>
		    <a href="/sitemap.xml">网站地图</a>&nbsp; &nbsp;			
			<a href="mailto:xywbupt@126.com" target="_blank">联系博主</a>&nbsp; &nbsp;	
			<a href="http://tongji.baidu.com/web/18697832">站长统计</a>			
		  </td>
        </tr>
      </table>
    </div>
</div>
</footer>
<!-- add by yurixu 2016/1/1 add website counter -->
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories/Read/" class="mobile-nav-link">Reading</a>
  
    <a href="https://github.com/xuyuri" class="mobile-nav-link">GitHub</a>
  
    <a href="/atom.xml" class="mobile-nav-link">RSS</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
< !-- add by yurixu 替换Google的jquery并且添加判断逻辑 -->
<script src="//libs.baidu.com/jquery/2.0.3/jquery.min.js"></script>
<script type="text/javascript">
if (typeof jQuery == 'undefined') {
  document.write(unescape("%3Cscript src='/js/jquery-2.0.3.min.js' type='text/javascript'%3E%3C/script%3E"));
}
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

<!-- add by yurixu 2016/1/8 添加swiftype搜索代码 -->
<!-- 
<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','Fa9mKyRrtZcNX19oWoxv','2.0.0');
</script>
-->

  </div>
</body>
</html>